import{u as _,r as h,k as V,Y as Z,j as e,A as J,C as g,d as b,e as S,Z as A,g as u,L as c,I as o,B as j,v as K}from"./index-UcHA7cXD.js";import{P as Q,L as W,a as F}from"./progress-2DAR-cFr.js";import{D as X,a as ee,b as se,c as te,d as ae}from"./dialog-DfaedrWr.js";import{f as v,T as ne}from"./format-g-E1R7xw.js";const G=[{id:"marriage",name:"الزواج",icon:"💍"},{id:"car",name:"شراء سيارة",icon:"🚗"},{id:"house",name:"شراء منزل",icon:"🏠"},{id:"business",name:"بدء مشروع",icon:"💼"},{id:"education",name:"التعليم",icon:"🎓"},{id:"other",name:"أخرى",icon:"🎯"}],re=[{title:"التطوير البرمجي",description:"تعلم البرمجة لتطوير تطبيقات الويب والهواتف",avgIncome:"5000-20000 ريال شهرياً",resources:["Udemy","Coursera","freeCodeCamp"]},{title:"التسويق الرقمي",description:"إدارة حملات التسويق الرقمي والتسويق عبر وسائل التواصل",avgIncome:"4000-15000 ريال شهرياً",resources:["Google Digital Garage","HubSpot Academy"]},{title:"التصميم الجرافيكي",description:"تصميم الشعارات والهويات البصرية والمحتوى المرئي",avgIncome:"3000-12000 ريال شهرياً",resources:["Adobe Tutorials","Behance","Dribbble"]}];function oe(){var I,T;const{toast:i}=_(),[r,p]=h.useState([]),[m,D]=h.useState(null),[H,y]=h.useState(!1),[f,M]=h.useState(0),[N,L]=h.useState(v(new Date,"yyyy-MM"));V({defaultValues:{amount:0}});const[n,d]=h.useState({type:"marriage",name:"",cost:0,targetDate:"",monthlySaving:0,currentSaving:0}),R=s=>{if(s.monthlySaving<=0)return 0;const t=s.cost-s.currentSaving;return Math.ceil(t/s.monthlySaving)},k=s=>{if(s<=0)return"0 شهر";const t=Math.floor(s/12),a=s%12;return t===0?`${a} شهر`:a===0?`${t} سنة`:`${t} سنة و${a} أشهر`},w=s=>{if(!s.targetDate)return 0;const t=new Date,a=new Date(s.targetDate),l=(a.getFullYear()-t.getFullYear())*12+(a.getMonth()-t.getMonth());if(l<=0)return 0;const x=s.cost-s.currentSaving;return Math.ceil(x/l)},E=s=>{const t=v(new Date,"yyyy-MM");return s.monthlySavingsHistory.some(a=>a.month===t)},$=()=>{if(n.name.trim()===""){i({title:"خطأ",description:"يرجى إدخال اسم الهدف",variant:"destructive"});return}if(n.cost<=0){i({title:"خطأ",description:"يرجى إدخال تكلفة صحيحة للهدف",variant:"destructive"});return}if(!n.targetDate){i({title:"خطأ",description:"يرجى تحديد تاريخ مستهدف للهدف",variant:"destructive"});return}if(new Date(n.targetDate)<=new Date){i({title:"خطأ",description:"يجب أن يكون التاريخ المستهدف في المستقبل",variant:"destructive"});return}const a=w(n),l=`goal-${Date.now()}-${Math.floor(Math.random()*1e3)}`;p([...r,{...n,id:l,monthlySaving:n.monthlySaving||a,monthlySavingsHistory:[]}]),d({type:"marriage",name:"",cost:0,targetDate:"",monthlySaving:0,currentSaving:0}),i({title:"تم الإضافة",description:"تم إضافة الهدف الجديد بنجاح"})},O=s=>{D(s),y(!0)},P=()=>{if(m){if(f<=0){i({title:"خطأ",description:"يرجى إدخال مبلغ صحيح للتوفير",variant:"destructive"});return}p(r.map(s=>{if(s.id===m){const t=s.monthlySavingsHistory.findIndex(x=>x.month===N);let a=[...s.monthlySavingsHistory];t>=0?a[t]={month:N,amount:f,date:new Date().toISOString()}:a.push({month:N,amount:f,date:new Date().toISOString()});const l=a.reduce((x,z)=>x+z.amount,0);return{...s,currentSaving:l,monthlySavingsHistory:a}}return s})),y(!1),D(null),M(0),i({title:"تم التحديث",description:"تم تسجيل التوفير الشهري بنجاح"})}},C=s=>Math.min(100,s.currentSaving/s.cost*100),B=s=>{const t=new Date(s);return v(t,"d MMMM yyyy",{locale:F})},Y=s=>{const[t,a]=s.split("-"),l=new Date(parseInt(t),parseInt(a)-1,1);return v(l,"MMMM yyyy",{locale:F})},U=s=>{const t=G.find(a=>a.id===s);return t?t.icon:"🎯"},q=s=>{p(r.filter(t=>t.id!==s)),i({title:"تم الحذف",description:"تم حذف الهدف بنجاح"})};return Z.useEffect(()=>{const s=new Date;v(s,"yyyy-MM"),r.forEach(t=>{!E(t)&&(!t.lastReminderDate||new Date(t.lastReminderDate).getMonth()!==s.getMonth())&&(i({title:`تذكير بهدفك: ${t.name}`,description:`يجب عليك ادخار ${t.monthlySaving} ريال هذا الشهر للوصول إلى هدفك في الوقت المحدد.`}),p(r.map(a=>a.id===t.id?{...a,lastReminderDate:s.toISOString()}:a)))})},[r,i]),e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(J,{showBackButton:!0,title:"الأهداف الكبرى"}),e.jsx("div",{className:"container mx-auto py-6 px-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(S,{className:"flex items-center gap-2 text-xl",children:[e.jsx(A,{className:"h-5 w-5"}),"إضافة هدف مالي جديد"]})}),e.jsx(u,{children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"goal-type",children:"نوع الهدف"}),e.jsx("select",{id:"goal-type",className:"w-full rounded-md border border-gray-300 p-2 mt-1",value:n.type,onChange:s=>d({...n,type:s.target.value}),children:G.map(s=>e.jsxs("option",{value:s.id,children:[s.icon," ",s.name]},s.id))})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"goal-name",children:"اسم الهدف"}),e.jsx(o,{id:"goal-name",placeholder:"مثال: شراء سيارة تويوتا كامري",value:n.name,onChange:s=>d({...n,name:s.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"goal-cost",children:"تكلفة الهدف (ريال)"}),e.jsx(o,{id:"goal-cost",type:"number",placeholder:"التكلفة الإجمالية",value:n.cost||"",onChange:s=>d({...n,cost:Number(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"goal-target-date",children:"تاريخ تحقيق الهدف"}),e.jsx(o,{id:"goal-target-date",type:"date",value:n.targetDate,onChange:s=>d({...n,targetDate:s.target.value})})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"goal-current-saving",children:"المبلغ المتوفر حالياً (ريال)"}),e.jsx(o,{id:"goal-current-saving",type:"number",placeholder:"المبلغ المتوفر حالياً",value:n.currentSaving||"",onChange:s=>d({...n,currentSaving:Number(s.target.value)})})]})]}),e.jsxs("div",{children:[e.jsxs(c,{htmlFor:"goal-monthly-saving",children:["المبلغ الشهري المخطط توفيره (ريال)",n.targetDate&&e.jsxs("span",{className:"text-xs text-gray-500 block",children:["المبلغ المقترح: ",w(n)," ريال شهرياً"]})]}),e.jsx(o,{id:"goal-monthly-saving",type:"number",placeholder:"المبلغ الشهري",value:n.monthlySaving||"",onChange:s=>d({...n,monthlySaving:Number(s.target.value)})})]}),e.jsx(j,{onClick:$,children:"إضافة الهدف"})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h2",{className:"text-xl font-bold",children:["أهدافك المالية (",r.length,")"]}),r.length===0?e.jsx(g,{children:e.jsxs(u,{className:"text-center py-8",children:[e.jsx(A,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("p",{className:"mt-4 text-gray-500",children:"لم تقم بإضافة أي هدف مالي بعد"})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(s=>e.jsxs(g,{children:[e.jsx(b,{className:"pb-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs(S,{className:"text-lg",children:[e.jsx("span",{className:"inline-block mr-2",children:U(s.type)}),s.name]}),e.jsx("div",{className:"flex space-x-2",children:e.jsx(j,{variant:"ghost",size:"sm",className:"text-red-500 h-8 px-2",onClick:()=>q(s.id),children:"حذف"})})]})}),e.jsx(u,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"التكلفة الإجمالية:"}),e.jsxs("span",{className:"font-bold",children:[s.cost.toLocaleString()," ريال"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"المبلغ المتوفر حالياً:"}),e.jsxs("span",{className:"font-bold",children:[s.currentSaving.toLocaleString()," ريال"]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"نسبة الإنجاز:"}),e.jsxs("span",{className:"font-bold",children:[C(s).toFixed(1),"%"]})]}),e.jsx(Q,{value:C(s),className:"h-2"})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"المبلغ الشهري المطلوب:"}),e.jsxs("span",{className:"font-bold",children:[s.monthlySaving.toLocaleString()," ريال"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"المدة المتبقية:"}),e.jsx("span",{className:"font-bold",children:k(R(s))})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"التاريخ المستهدف:"}),e.jsx("span",{className:"font-bold",children:B(s.targetDate)})]}),e.jsxs("div",{className:"pt-3 border-t border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs(j,{size:"sm",onClick:()=>O(s.id),className:"bg-green-600 hover:bg-green-700 text-xs",children:[e.jsx(K,{className:"h-4 w-4 ml-1"}),"إضافة إدخار هذا الشهر"]}),e.jsx("h4",{className:"text-sm font-bold",children:"سجل الادخار الشهري"})]}),s.monthlySavingsHistory.length>0?e.jsx("div",{className:"max-h-36 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-right",children:"الشهر"}),e.jsx("th",{className:"text-right",children:"المبلغ"})]})}),e.jsx("tbody",{children:s.monthlySavingsHistory.sort((t,a)=>new Date(a.date).getTime()-new Date(t.date).getTime()).map((t,a)=>e.jsxs("tr",{className:"border-b border-gray-100",children:[e.jsx("td",{className:"py-1",children:Y(t.month)}),e.jsxs("td",{className:"py-1 font-semibold",children:[t.amount.toLocaleString()," ريال"]})]},a))})]})}):e.jsx("p",{className:"text-sm text-center text-gray-500",children:"لم تسجل أي مبالغ مدخرة بعد"})]})]})})]},s.id))})]}),e.jsxs(g,{children:[e.jsx(b,{children:e.jsxs(S,{className:"flex items-center gap-2 text-xl",children:[e.jsx(W,{className:"h-5 w-5"}),"فرص لزيادة الدخل"]})}),e.jsx(u,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:re.map((s,t)=>e.jsx(g,{children:e.jsxs(u,{className:"p-4",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.description}),e.jsxs("p",{className:"text-sm mb-2",children:[e.jsx("span",{className:"font-bold",children:"متوسط الدخل: "}),s.avgIncome]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-bold",children:"مصادر للتعلم: "}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:s.resources.map((a,l)=>e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs px-2 py-1 rounded",children:a},l))})]})]})},t))})})]})]})}),e.jsx(X,{open:H,onOpenChange:y,children:e.jsxs(ee,{className:"sm:max-w-[425px]",children:[e.jsx(se,{children:e.jsxs(te,{className:"text-right font-cairo",children:["إضافة مبلغ الادخار الشهري",m&&e.jsx("div",{className:"text-sm font-normal text-gray-500 mt-1",children:(I=r.find(s=>s.id===m))==null?void 0:I.name})]})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(c,{htmlFor:"month",className:"text-right col-span-1",children:"الشهر"}),e.jsx(o,{id:"month",type:"month",className:"col-span-3",value:N,onChange:s=>L(s.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(c,{htmlFor:"amount",className:"text-right col-span-1",children:"المبلغ"}),e.jsxs("div",{className:"col-span-3 flex items-center gap-2",children:[e.jsx(o,{id:"amount",type:"number",placeholder:"أدخل المبلغ الذي وفرته هذا الشهر",value:f||"",onChange:s=>M(Number(s.target.value))}),e.jsx("span",{children:"ريال"})]})]}),m&&e.jsx("div",{className:"text-sm text-amber-600 mt-2",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"h-4 w-4"}),e.jsx("span",{children:"المبلغ المطلوب شهرياً:"}),e.jsxs("strong",{children:[(T=r.find(s=>s.id===m))==null?void 0:T.monthlySaving.toLocaleString()," ريال"]})]})})]}),e.jsxs(ae,{children:[e.jsx(j,{variant:"outline",onClick:()=>y(!1),children:"إلغاء"}),e.jsx(j,{onClick:P,children:"حفظ المبلغ"})]})]})})]})}export{oe as default};
